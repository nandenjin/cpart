<!DOCTYPE html>
<html>
<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <meta name="robots" content="noindex">

  <title>Rhythm! - Computer Art 2018</title>

</head>
<body>

  <div id="app" style="display: none;">

    <input type="text" v-model="name" placeholder="名前を入れてください">
    
    <div v-if="sw">
      
      <button @click="send">{{ cnt }}</button>

    </div>

    <div v-else>
      
      Computer Art 2018

    </div>

  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/vue"></script>
  <script>
    
    let ws;

    const app = new Vue( {

      el: "#app",

      data: {

        sw: false,
        cnt: 0,
        name: ''

      },

      mounted() {

        document.getElementById( "app" ).style.display = "block";

        ws = new WebSocket( "ws://" + location.host );

        ws.addEventListener( 'message', e => {

          const data = JSON.parse( e.data );

          console.log( data );

          if( data.sw !== undefined ) this.sw = data.sw;

        } );

      },

      methods: {

        send() {

          ws.send( JSON.stringify( { kind: this.cnt++, name: this.name } ) );

        }

      }

    } );


  </script>

</body>
</html>